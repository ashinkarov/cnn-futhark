\section{Runtime Evaluation}

In this section we compare the performance of the code generated by Agda,
with the hand-written version of \cite{}. 

\subsection{Experimental Setup}

We use a multicore machine consisting of two 16 core AMD EPYC 7313
CPUs running at a 3.7 GHz frequency. The peak performance of this 
machine is $1894$ Gflops/s.
We use SaC 1.3.3 with GCC version 11.4.0.

We run each experiment ten times, and report error bars two standard deviations
wide.

\subsection{Timings}

\begin{figure*}[ht]
    \begin{subfigure}{0.4\textwidth}
        \begin{adjustbox}{max width=\textwidth}
        \begin{tikzpicture}
            \begin{loglogaxis}[
                xlabel=threads,
                ylabel=Gflops/s,
                xtick = {1, 2, 4, 8, 16, 32},
                xticklabels = {1, 2, 4, 8, 16, 32},
                ytick = {5, 10, 20, 40, 80, 160},
                yticklabels = {5, 10, 20, 40, 80, 160},
            ]

                \addplot+ [
                    error bars/.cd,
                        y explicit,
                        y dir=both,
                ] table [
                    x=p,
                    y=mean,
                    y error plus expr=\thisrow{stddev},
                    y error minus expr=\thisrow{stddev},
                ] {data/train2021.csv};

                \legend{Handwritten}
            \end{loglogaxis}
        \end{tikzpicture}
        \end{adjustbox}
        \caption{Training on $10000$ images, for $40$ epochs, with a 
                 batchsize of $100$ and learning rate of $0.01$.}%
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.4\textwidth}
        \begin{adjustbox}{max width=\textwidth}
        \begin{tikzpicture}
            \begin{loglogaxis}[
                xlabel=threads,
                ylabel=Gflops/s,
                xtick = {1, 2, 4, 8, 16, 32},
                xticklabels = {1, 2, 4, 8, 16, 32},
                ytick = {5, 10, 20, 40, 80, 160},
                yticklabels = {5, 10, 20, 40, 80, 160},
            ]

                \addplot+ [
                    error bars/.cd,
                        y explicit,
                        y dir=both,
                ] table [
                    x=p,
                    y expr=\thisrow{mean},
                    y error plus expr=\thisrow{stddev},
                    y error minus expr=\thisrow{stddev},
                ] {data/test2021.csv};

                \legend{Handwritten}
            \end{loglogaxis}
        \end{tikzpicture}
        \end{adjustbox}
        \caption{Testing the resulting network on $10000$ images. We obtain
                 a recognition rate of $72\%$.}
    \end{subfigure}
        \caption{Scaling of training and testing for both the generated code,
                 and a handwritten version.}\label{fig:runtimes}
\end{figure*}
